
- id: home
  type: page
  title: Enrollment Admin
  icon: home
  text: |
    This is a subset of functionality of Rex Study Enrollment Admin implemented
    in terms of Rex Workflow configurable UI.

    To the right you can see two next possible actions, namely "List studies" and "List individuals".

    This is snippet which configures the workflow:: 

      /:
        workflow:
          actions:
            home:
              list-individuals:
                view-individual:
              list-studies:
                view-study:
                list-individuals-to-enroll:
                  create-study-enrollment:

- id: list-individuals
  type: list
  entity: individual

- id: list-individuals-to-enroll
  type: list
  title: List individuals to enroll
  entity: individual 
  resizable_columns: true
  sortable: true
  columns:
  - code
  - identity.givenname
  - identity.surname
  - sex
  requirements:
  - exists(study_recruitment.study=$study)

- id: view-individual
  type: view
  entity: individual

- id: list-studies
  type: list
  entity: study
  columns:
  - code
  - title
  - start_date
  - closed
  - key: lab
    expression: lab.title
    name: Lab

- id: view-study
  type: view
  entity: study

- id: create-study-enrollment
  type: create
  title: Enroll
  entity: study_enrollment

  value:
    study: $study
    individual: $individual

  # enumerate create form fields
  fields:
  - enrollment_date
  - type: file
    name: Consent Form Scan
    key: consent_form_scan
    storage: rex.file:/
    download: rex.study.enrollment_admin:/data/consent

  # provide form field overrides
  fields_override:
    enrollment_date:
      key: enrollment_date
      type: date
      name: Enrollment date
