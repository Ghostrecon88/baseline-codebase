{% from 'files.html' import files with context %}
{% import 'rex.forms:/macros.html' as macro with context %}
{% import "rex.vendor:/template/macro.html" as vendor with context %}
<html>
<head>
    <title>Suite: {% if PARAMS.run %}{{ PARAMS.run|e }}{% else %}all{% endif %}</title>
    {{ macro.client_head() }}
    {{ vendor.jquery_mockjax() }}
    <script type="text/javascript">
        window.customSaveStateResponse = null;
        $.mockjax({
            url: '/test/save_state',
            response: function (req) {
                if (window.customSaveStateResponse)
                    window.customSaveStateResponse(req, this)
                else
                    this.responseText = '{"result":"true"}';
            }
        });
    </script>
    <script type="text/javascript" src="common.js"></script>

    <style>
        html, body {
            width: 100%;
            height: 100%;
            margin: 0px;
            padding: 0px;
        }

        body {
            position: relative;
            font-family: "Helvetica Neue Light","HelveticaNeue-Light","Helvetica Neue",Calibri,Helvetica,Arial,sans-serif;
            font-size: small;
        }

        #qunit {
            position: absolute;
            right: 5px;
            top: 35px;
            bottom: 5px;
            width: 600px;
        }

        #qunit-fixture {
            position: absolute;
            left: 5px !important;
            right: 610px !important;
            top: 35px !important;
            bottom: 5px !important;
        }

        #menu {
            height: 30px;
            background: #e3e3e3;
        }

        #menu a {
            margin-top: 4px;
            display: inline-block;
            margin-left: 4px;
            color: #555555; 
        }

        span#qunit-modulefilter-container>label {
            display: none;
        }

    </style>
    <script>
        window.J = {
            "basic": {% include 'json/basic.json' %},
            "require": {% include 'json/require.json' %},
            "save_load": {% include 'json/save_load.json' %}
        };
    </script>

    {{ vendor.qunit() }}
    <script src="{{ MOUNT['rex.forms'] }}/js/qunit-dom.js"></script>

    {% if not PARAMS.run %}
        {% for file in files %}
        <script src="suites/{{ file }}.js"></script>
        {% endfor %}
    {% else %}
        <script src="suites/{{ PARAMS.run }}.js"></script>
    {% endif %}
</head>
<body>
    <div id="menu" style="font-weight: bold;">
        <a href="index.html">all</a>
        {% for file in files %}
        <a href="test.html?run={{ file }}">{{ file }}</a>
        {% endfor %}
    </div>
    <div id="qunit-fixture"></div>
    <div id="qunit"></div>
</body>
</html>
