---
- table: user
  with:
  - column: remote_user
    type: text
  - column: expires
    type: datetime
    required: false
  - column: system_admin
    was: site_admin
    type: boolean
    required: true
    default: false

  - identity: [remote_user]

- table: contact_info
  with:
  - column: code
    type: integer
  - link: user
  - column: type
    type: [phone, twitter, other]
  - column: value
    type: text

  - identity: [user, code: offset]

- table: patient
  with:
  - column: code
    type: integer
  - column: name
    type: text
  - link: caregiver
    to: user
  - column: date_of_birth
    type: date

  - identity: [code: offset]

# DATA

- table: user
  with:
  - data:
    - remote_user: savitha@prometheusresearch.com
      system_admin: true
    - remote_user: jason@prometheusresearch.com
      system_admin: true
    - remote_user: xi@prometheusresearch.com
      system_admin: true
    - remote_user: andrey@prometheusresearch.com
      system_admin: true
    - remote_user: konstantin@prometheusresearch.com
      system_admin: true
    - remote_user: marcin@prometheusresearch.com
      system_admin: true
    - remote_user: leon@prometheusresearch.com
      system_admin: true
    - remote_user: john@prometheusresearch.com
      system_admin: true
    - remote_user: cce@prometheusresearch.com
      system_admin: true
    - remote_user: zindel@prometheusresearch.com
      system_admin: true
    - remote_user: ben@prometheusresearch.com
      system_admin: false
    - remote_user: alex@prometheusresearch.com
      system_admin: false

- include: ./deploy_user.yaml
- include: ./deploy_patient.yaml

- table: contact_info
  with:
  - data:
    - user: "'savitha@prometheusresearch.com'"
      code: 1
      type: phone
      value: 555-55-55
    - user: "'jason@prometheusresearch.com'"
      code: 1
      type: phone
      value: 555-55-44
    - user: "'xi@prometheusresearch.com'"
      code: 1
      type: phone
      value: 555-55-33
    - user: "'andrey@prometheusresearch.com'"
      code: 1
      type: phone
      value: 555-55-22
    - user: "'andrey@prometheusresearch.com'"
      code: 2
      type: twitter
      value: andreypopp
    - user: "'konstantin@prometheusresearch.com'"
      code: 1
      type: phone
      value: 555-55-11
